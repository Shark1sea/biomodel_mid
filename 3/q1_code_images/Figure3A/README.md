[cite_start]这段代码的主要目的是使用 `brian2` 神经网络模拟器复现 Xiao-Jing Wang (2002) 论文中的 **Figure 3A** [cite: 157-158]。该图展示了在**零相干度（0% coherence）**输入下，皮层网络如何通过随机噪声积累形成决策。

以下是代码的工作原理分解以及生成的四张子图的具体含义：

### 1. 代码工作原理

代码的执行流程分为模拟、数据处理、结果判定和绘图四个阶段：

* **模拟设置与运行 (`sim.run`)**:
    * [cite_start]代码设置了刺激参数 `coh = 0.0`，意味着输入给决策群组 A 和 B 的平均信号强度是完全相等的，没有任何偏差 [cite: 127]。
    * 模拟持续 2 秒，其中 0.5s 到 1.5s 是刺激呈现期。
    * [cite_start]`sim.run(T, randseed=64321)` 运行神经网络模拟。由于输入是相等的，最终的赢家（选择 A 还是 B）完全取决于网络内部的随机噪声波动 [cite: 173-174]。

* **计算放电率 (`get_rate`)**:
    * 从模拟器监视器中提取神经元的脉冲时间（Spike times）。
    * 使用 50ms 的时间窗口计算群组 A（红色）和群组 B（蓝色）的平均放电率（Firing Rate）。

* **获胜方判定逻辑 (新增部分)**:
    * 代码检查延迟期（`t > 1.5s`）的平均放电率。
    * [cite_start]在决策形成后，获胜的群组会保持高放电率（Attractor state），而失败的群组会被抑制 [cite: 95-96]。
    * **逻辑**：如果 `mean_rate_A > mean_rate_B`，则判定 A 获胜，文件命名为 `Figure3A_Re_A_win.png`；反之则命名为 `Figure3A_Re_B_win.png`。

* **绘图 (Matplotlib)**:
    * 代码生成一个包含 4 个子图的垂直布局，分别展示决策过程的不同侧面。

---

### 2. 图像含义解析 (四个子图)

[cite_start]生成的图像直观地展示了决策形成的动态过程。根据论文 [cite: 157-160]，从上到下的四个子图分别代表：

#### **第一张图：光栅图 (Raster Plot)**
* **显示内容**：黑点代表神经元的发放时刻。Y 轴是神经元索引，X 轴是时间。
* [cite_start]**意义**：展示了原始的神经活动。你可以看到在刺激开始后（0.5s），神经元的发放变得密集。随着时间推移，代表获胜群组（例如 A）的神经元发放变得更加同步和密集，而另一组则逐渐稀疏。这反映了网络中群体活动的随机性 [cite: 159]。

#### **第二张图：群体放电率 (Population Firing Rates)**
* **显示内容**：红色曲线代表群组 A 的平均放电率，蓝色曲线代表群组 B。
* **意义**：这是决策过程的核心视图。
    * [cite_start]**初始阶段**：两条线纠缠在一起，代表网络处于犹豫状态（随机游走）[cite: 129]。
    * **分歧点**：随着时间推移，两条线剧烈分离（Divergence）。红线（如果 A 赢）上升到高发放率（~40Hz），蓝线下降。
    * [cite_start]这展示了“胜者通吃”（Winner-take-all）的竞争机制 [cite: 103]。

#### **第三张图：随机输入 (Stochastic Inputs)**
* **显示内容**：模拟输入给群组 A 和 B 的瞬时信号强度。
* [cite_start]**意义**：虽然平均信号强度相等（因为相干度为 0%），但每时每刻的信号都包含高斯噪声 [cite: 89][cite_start]。这展示了输入信号的嘈杂本质——即使没有明确的信号差异，噪声本身也会产生微小的瞬时偏差 [cite: 174]。

#### **第四张图：输入的时间积分 (Time Integral of Inputs)**
* **显示内容**：这是第三张图中输入信号的累积和（$\int (Input) dt$）。
* **意义**：这解释了**为什么**某一方会赢。
    * 在零相干度下，网络实际上是在对噪声进行积分。
    * [cite_start]如果红线（Integral A）在某一时刻偶然高于蓝线，这种微小的偏差会被网络内部的循环兴奋连接放大，最终导致 A 赢得竞争 [cite: 176-177]。
    * [cite_start]此图证明了即便外部刺激没有偏差，输入噪声的时间积分偏差也足以打破对称性，驱动决策 [cite: 185]。
